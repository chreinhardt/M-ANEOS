C
C
      SUBROUTINE ANEI3 (ARG,EXPARG,ANS)
C
C***********************************************************************
C
C     ANEOS PACKAGE          DETERMINES THIRD EXPONENTIAL INTEGRAL
C     EXPARG=EXP(-ARG)       EXPIN=FIRST EXPONENTIAL INTEGRAL
C
C************************************** 8/87 version slt ***************
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION CE(5)
      PARAMETER (ZERO=0.D0)
      PARAMETER (HALF=0.5D0)
      PARAMETER (ONE=1.D0)
      PARAMETER (TWO=2.D0)
      PARAMETER (CEO=-.57721566D0)
      PARAMETER (AE1=8.5733287D0)
      PARAMETER (AE2=18.059017D0)
      PARAMETER (AE3=8.6347609D0)
      PARAMETER (AE4=.26777373D0)
      PARAMETER (BE1=9.5733223D0)
      PARAMETER (BE2=25.632956D0)
      PARAMETER (BE3=21.099653D0)
      PARAMETER (BE4=3.9584969D0)
      PARAMETER (QCF=100.D0)
      DATA (CE(I),I=1,5)
     1/.99999193D0,-.24991055D0,.05519968D0,-.00976004D0,.00107857D0/
      IF (ARG.GT.ONE) GO TO 20
      EXPIN=CEO-LOG(ARG)
      X1=ONE
        DO 10 I=1,5
        X1=ARG*X1
   10   EXPIN=EXPIN+X1*CE(I)
      GO TO 40
   20 IF (ARG.LT.QCF) GO TO 30
        EXPIN=ZERO
        GO TO 40
   30 EXPIN=EXPARG*(((((ARG+AE1)*ARG+AE2)*ARG+AE3)*ARG+AE4)/
     1       (ARG*((((ARG+BE1)*ARG+BE2)*ARG+BE3)*ARG+BE4)))
   40 ANS=HALF*(EXPARG-ARG*(EXPARG-ARG*EXPIN))
      RETURN
      END
